The file AESencrypt.hs contains a haskell script which performs the encryption step of AES using the Boyar-Peralta sBox circut and expects an already expanded key. The file AESwithBPSBox.json was created by transforming the AESencrypt.hs file into verilog using Clash and then into a boolean circuit using yosys.

Compilation for Verilog:
stack exec clash -- --verilog src/Example/Project.hs

Compilation for testing:
stack ghci --package clash-prelude --ghci-options "-fobject-code" src/Example/Project.hs

test vectors: plaintext = 0x00112233445566778899AABBCCDDEEFF
                    key = 0x000102030405060708090A0B0C0D0E0F
                     ct = 0x69c4e0d86a7b0430d8cdb78070b4c55a

## Test encryption only

>import Clash.Prelude
>import Example.Project

>let pt = Plaintext $ 0x00 :> 0x11 :> 0x22 :> 0x33 :> 0x44 :> 0x55 :> 0x66 :> 0x77 :> 0x88 :> 0x99 :> 0xAA :> 0xBB :>    0xCC :> 0xDD :> 0xEE :> 0xFF :> Nil
>let Ciphertext ct = aesBlockEncrypt pt key
>let expkey = KeySchedule $ 0x00010203 :> 0x04050607 :> 0x08090A0B :> 0x0C0D0E0F :>  0xD6AA74FD :> 0xD2AF72FA :> 0xDAA678F1 :> 0xD6AB76FE :>  0xB692CF0B :> 0x643DBDF1 :> 0xBE9BC500 :> 0x6830B3FE :>  0xB6FF744E :> 0xD2C2C9BF :> 0x6C590CBF :> 0x0469BF41 :>  0x47F7F7BC :> 0x95353E03 :> 0xF96C32BC :> 0xFD058DFD :>  0x3CAAA3E8 :> 0xA99F9DEB :> 0x50F3AF57 :> 0xADF622AA :>  0x5E390F7D :> 0xF7A69296 :> 0xA7553DC1 :> 0x0AA31F6B :>  0x14F9701A :> 0xE35FE28C :> 0x440ADF4D :> 0x4EA9C026 :>  0x47438735 :> 0xA41C65B9 :> 0xE016BAF4 :> 0xAEBF7AD2 :>  0x549932D1 :> 0xF0855768 :> 0x1093ED9C :> 0xBE2C974E :>  0x13111D7F :> 0xE3944A17 :> 0xF307A78B :> 0x4D2B30C5 :> Nil


# Expected
> ct
>0b0110_1001 :> 0b1100_0100 :> 0b1110_0000 :> 0b1101_1000 :> 0b0110_1010 :> 0b0111_1011 :> 0b0000_0100 :> 0b0011_0000 :> 0b1101_1000 :> 0b1100_1101 :> 0b1011_0111 :> 0b1000_0000 :> 0b0111_0000 :> 0b1011_0100 :> 0b1100_0101 :> 0b0101_1010 :> Nil

## Test key expansion

>let pt = Plaintext $ 0x00 :> 0x11 :> 0x22 :> 0x33 :> 0x44 :> 0x55 :> 0x66 :> 0x77 :> 0x88 :> 0x99 :> 0xAA :> 0xBB :>    0xCC :> 0xDD :> 0xEE :> 0xFF :> Nil
>let key = Key $  0x00010203 :> 0x04050607 :> 0x08090A0B :> 0x0C0D0E0F :> Nil
>let expandedkey = nistKeyExpand key



# Expected
>KeySchedule (0b0000_0000_0000_0001_0000_0010_0000_0011 :> 0b0000_0100_0000_0101_0000_0110_0000_0111 :> 0b0000_1000_0000_1001_0000_1010_0000_1011 :> 0b0000_1100_0000_1101_0000_1110_0000_1111 :> 0b1101_0110_1010_1010_0111_0100_1111_1101 :> 0b1101_0010_1010_1111_0111_0010_1111_1010 :> 0b1101_1010_1010_0110_0111_1000_1111_0001 :> 0b1101_0110_1010_1011_0111_0110_1111_1110 :> 0b1011_0110_1001_0010_1100_1111_0000_1011 :> 0b0110_0100_0011_1101_1011_1101_1111_0001 :> 0b1011_1110_1001_1011_1100_0101_0000_0000 :> 0b0110_1000_0011_0000_1011_0011_1111_1110 :> 0b1011_0110_1111_1111_0111_0100_0100_1110 :> 0b1101_0010_1100_0010_1100_1001_1011_1111 :> 0b0110_1100_0101_1001_0000_1100_1011_1111 :> 0b0000_0100_0110_1001_1011_1111_0100_0001 :> 0b0100_0111_1111_0111_1111_0111_1011_1100 :> 0b1001_0101_0011_0101_0011_1110_0000_0011 :> 0b1111_1001_0110_1100_0011_0010_1011_1100 :> 0b1111_1101_0000_0101_1000_1101_1111_1101 :> 0b0011_1100_1010_1010_1010_0011_1110_1000 :> 0b1010_1001_1001_1111_1001_1101_1110_1011 :> 0b0101_0000_1111_0011_1010_1111_0101_0111 :> 0b1010_1101_1111_0110_0010_0010_1010_1010 :> 0b0101_1110_0011_1001_0000_1111_0111_1101 :> 0b1111_0111_1010_0110_1001_0010_1001_0110 :> 0b1010_0111_0101_0101_0011_1101_1100_0001 :> 0b0000_1010_1010_0011_0001_1111_0110_1011 :> 0b0001_0100_1111_1001_0111_0000_0001_1010 :> 0b1110_0011_0101_1111_1110_0010_1000_1100 :> 0b0100_0100_0000_1010_1101_1111_0100_1101 :> 0b0100_1110_1010_1001_1100_0000_0010_0110 :> 0b0100_0111_0100_0011_1000_0111_0011_0101 :> 0b1010_0100_0001_1100_0110_0101_1011_1001 :> 0b1110_0000_0001_0110_1011_1010_1111_0100 :> 0b1010_1110_1011_1111_0111_1010_1101_0010 :> 0b0101_0100_1001_1001_0011_0010_1101_0001 :> 0b1111_0000_1000_0101_0101_0111_0110_1000 :> 0b0001_0000_1001_0011_1110_1101_1001_1100 :> 0b1011_1110_0010_1100_1001_0111_0100_1110 :> 0b0001_0011_0001_0001_0001_1101_0111_1111 :> 0b1110_0011_1001_0100_0100_1010_0001_0111 :> 0b1111_0011_0000_0111_1010_0111_1000_1011 :> 0b0100_1101_0010_1011_0011_0000_1100_0101 :> Nil)



